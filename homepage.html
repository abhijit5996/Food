<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recommended Foods - NutriOrder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Page transition animations */
        body {
            opacity: 0;
            animation: fadeIn 0.5s ease-in forwards;
            font-family: 'Poppins', sans-serif;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Link transitions */
        a, button {
            transition: all 0.3s ease;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1a202c;
        }

        ::-webkit-scrollbar-thumb {
            background: #4a5568;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }

        /* Animation for hover effects */
        .hover\:scale-105:hover {
            transform: scale(1.05);
        }

        /* Custom glow effect */
        .glow {
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.5);
        }

        /* Responsive tweaks */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.1rem;
            }
        }
    </style>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js";
  
        const firebaseConfig = {
          apiKey: "AIzaSyBx0Kt9o04ye0XrtA8ecp84wD8Q9OCDjlA",
          authDomain: "foodorder-4380c.firebaseapp.com",
          projectId: "foodorder-4380c",
          storageBucket: "foodorder-4380c.firebasestorage.app",
          messagingSenderId: "735023580381",
          appId: "1:735023580381:web:c6740bef2fc9bdee1b4734"
        };
  
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Check auth state
        onAuthStateChanged(auth, (user) => {
          if (!user) {
            // If not logged in, redirect to login page
            localStorage.setItem('redirectAfterLogin', window.location.href);
            window.location.href = 'login.html';
          } else {
            // Update profile name if logged in
            const profileName = document.getElementById('profile-name');
            if (profileName) {
              profileName.textContent = user.displayName || user.email.split('@')[0];
            }
          }
        });
  
        // Google sign-in function
        window.signInWithGoogle = async function() {
          try {
            const result = await signInWithPopup(auth, provider);
            const user = result.user;
            window.location.href = 'homepage.html';
          } catch (error) {
            console.error('Google sign-in error:', error);
            alert('Google sign-in failed: ' + error.message);
          }
        };

        // Logout function
        window.logout = async function() {
          try {
            await signOut(auth);
            window.location.href = 'index.html';
          } catch (error) {
            console.error('Logout error:', error);
          }
        };
    </script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#8b5cf6',
                        secondary: '#7c3aed',
                        dark: '#1f2937',
                        light: '#f3f4f6'
                    },
                    animation: {
                        'click': 'click 300ms ease-out',
                    },
                    keyframes: {
                        click: {
                            '0%, 100%': { transform: 'scale(1)' },
                            '50%': { transform: 'scale(0.95)' },
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
    <!-- Header/Navigation -->
    <header class="sticky top-0 z-50 bg-gray-800 shadow-md">
        <div class="container mx-auto flex flex-wrap p-5 flex-col md:flex-row items-center">
            <a href="index.html" class="flex title-font font-medium items-center text-white mb-4 md:mb-0">
                <i class="fas fa-utensils text-purple-500 text-2xl mr-2"></i>
                <span class="ml-3 text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-pink-600">NutriOrder</span>
            </a>
            <nav class="md:ml-auto flex flex-wrap items-center text-base justify-center">
                <a href="homepage.html" class="mr-5 hover:text-purple-400 transition">Home</a>
                <a href="recommended.html" class="mr-5 hover:text-purple-400 transition">Recommended</a>
                <a href="restaurants.html" class="mr-5 hover:text-purple-400 transition">Restaurants</a>
            </nav>
            <button id="theme-toggle" class="p-2 rounded-lg focus:outline-none text-gray-300 hover:bg-gray-700 mr-4">
                <i class="fas fa-moon dark:hidden"></i>
                <i class="fas fa-sun hidden dark:block"></i>
            </button>
            <button onclick="toggleCart()" class="inline-flex items-center bg-purple-600 text-white border-0 py-2 px-4 focus:outline-none hover:bg-purple-700 rounded-lg transition mr-4">
                <i class="fas fa-shopping-cart mr-2"></i> Cart
                <span id="cart-count" class="ml-2 bg-white text-purple-600 rounded-full w-6 h-6 flex items-center justify-center">0</span>
            </button>
            <div class="relative">
                <button id="profile-button" class="inline-flex items-center bg-gray-700 text-white border-0 py-2 px-4 focus:outline-none hover:bg-gray-600 rounded-lg transition">
                    <i class="fas fa-user-circle mr-2"></i> <span id="profile-name"></span>
                </button>
                <div id="profile-dropdown" class="absolute right-0 mt-2 w-48 bg-gray-800 rounded-md shadow-lg py-1 z-50 hidden border border-gray-700">
                    <a href="dashboard.html" class="block px-4 py-2 text-sm hover:bg-gray-700">Dashboard</a>
                    <a href="preferences.html" class="block px-4 py-2 text-sm hover:bg-gray-700">Preferences</a>
                    <a href="orders.html" class="block px-4 py-2 text-sm hover:bg-gray-700">My Orders</a>
                    <a href="#" onclick="logout()" class="block px-4 py-2 text-sm hover:bg-gray-700">Sign out</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Shopping Cart Sidebar -->
    <div id="cart-sidebar" class="fixed top-0 right-0 h-full w-80 bg-gray-800 shadow-lg transform translate-x-full transition-transform duration-300 ease-in-out z-50 overflow-y-auto border-l border-gray-700">
        <div class="p-4 border-b border-gray-700 flex justify-between items-center">
            <h3 class="text-lg font-semibold text-white">Your Order</h3>
            <button onclick="toggleCart()" class="text-gray-400 hover:text-white">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div id="cart-items" class="p-4">
            <!-- Cart items will be added here dynamically -->
            <p class="text-gray-400 text-center py-8">Your cart is empty</p>
        </div>
        <div class="p-4 border-t border-gray-700">
            <div class="flex justify-between mb-2 text-white">
                <span>Subtotal:</span>
                <span id="cart-subtotal">₹0.00</span>
            </div>
            <div class="flex justify-between mb-4 text-white">
                <span>Delivery:</span>
                <span>₹30.00</span>
            </div>
            <div class="flex justify-between font-bold text-lg text-white">
                <span>Total:</span>
                <span id="cart-total">₹30.00</span>
            </div>
            <a href="checkout.html" class="w-full bg-purple-600 text-white py-2 rounded-lg mt-4 hover:bg-purple-700 transition flex items-center justify-center">
                Checkout
            </a>
        </div>
    </div>
    <div id="cart-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40" onclick="toggleCart()"></div>

    <!-- Recommended Foods Section -->
    <section class="text-gray-300 body-font py-12">
        <div class="container px-5 mx-auto">
            <div class="flex flex-col text-center w-full mb-12">
                <h1 class="text-3xl font-bold title-font mb-4 text-white">Foods Recommended For You</h1>
                <p class="lg:w-2/3 mx-auto leading-relaxed">Based on your preferences and dietary needs</p>
            </div>
            
            <!-- Search and Filters -->
            <div class="mb-8 bg-gray-800 p-6 rounded-lg shadow">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                    <div class="relative flex-grow">
                        <input type="text" id="food-search" placeholder="Search recommended foods..." class="w-full bg-gray-700 rounded border border-gray-600 focus:border-purple-500 focus:bg-gray-600 focus:ring-2 focus:ring-purple-900 text-base outline-none text-white py-2 px-4 pl-10 leading-8 transition-colors duration-200 ease-in-out">
                        <i class="fas fa-search absolute left-3 top-3.5 text-gray-400"></i>
                    </div>
                    <div class="flex flex-wrap gap-3">
                        <select id="cuisine-filter" class="bg-gray-700 rounded border border-gray-600 focus:border-purple-500 focus:bg-gray-600 focus:ring-2 focus:ring-purple-900 text-base outline-none text-white py-2 px-3 leading-8 transition-colors duration-200 ease-in-out">
                            <option value="">All Cuisines</option>
                            <option value="indian">Indian</option>
                            <option value="italian">Italian</option>
                            <option value="chinese">Chinese</option>
                            <option value="mexican">Mexican</option>
                            <option value="american">American</option>
                        </select>
                        <select id="diet-filter" class="bg-gray-700 rounded border border-gray-600 focus:border-purple-500 focus:bg-gray-600 focus:ring-2 focus:ring-purple-900 text-base outline-none text-white py-2 px-3 leading-8 transition-colors duration-200 ease-in-out">
                            <option value="">All Diets</option>
                            <option value="vegetarian">Vegetarian</option>
                            <option value="vegan">Vegan</option>
                            <option value="gluten-free">Gluten-Free</option>
                            <option value="keto">Keto</option>
                            <option value="low-carb">Low Carb</option>
                            <option value="high-protein">High Protein</option>
                        </select>
                        <button id="reset-filters" class="text-gray-300 hover:text-purple-400 border border-gray-600 py-2 px-4 rounded-lg transition">
                            Reset
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Personalized Recommendations -->
            <div class="mb-8">
                <h2 class="text-xl font-bold title-font mb-6 text-white flex items-center">
                    <i class="fas fa-heart text-purple-500 mr-2"></i> Based on Your Preferences
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="recommended-foods">
                    <!-- Recommended items will be loaded here dynamically -->
                </div>
            </div>
            
            <!-- Recommended Restaurants -->
            <div class="mb-8">
                <h2 class="text-xl font-bold title-font mb-6 text-white flex items-center">
                    <i class="fas fa-utensils text-purple-500 mr-2"></i> Restaurants Matching Your Preferences
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" id="recommended-restaurants">
                    <!-- Restaurant cards will be loaded here dynamically -->
                </div>
            </div>
            
            <!-- Health Tips Based on Preferences -->
            <div class="bg-purple-900 bg-opacity-30 rounded-lg p-6">
                <h2 class="text-xl font-bold title-font mb-4 text-white flex items-center">
                    <i class="fas fa-lightbulb text-purple-400 mr-2"></i> Health Tips For You
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="health-tips">
                    <!-- Health tips will be loaded here dynamically -->
                </div>
            </div>
        </div>
    </section>

    <!-- Restaurant Menu Modal -->
    <div id="restaurant-menu-modal" class="hidden fixed inset-0 z-50 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 transition-opacity" aria-hidden="true">
                <div class="absolute inset-0 bg-gray-900 opacity-75" onclick="hideRestaurantMenu()"></div>
            </div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div class="inline-block align-bottom bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full border border-gray-700">
                <div class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg leading-6 font-medium text-white" id="restaurant-menu-title"></h3>
                                <button onclick="hideRestaurantMenu()" class="text-gray-400 hover:text-white">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="mt-4">
                                <p class="text-sm text-gray-400 mb-4" id="restaurant-menu-description"></p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="restaurant-menu-items">
                                    <!-- Menu items will be loaded here dynamically -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" onclick="hideRestaurantMenu()" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-purple-600 text-base font-medium text-white hover:bg-purple-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm transition">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Recipe Modal -->
    <div id="recipe-modal" class="hidden fixed inset-0 z-50 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 transition-opacity" aria-hidden="true">
                <div class="absolute inset-0 bg-gray-900 opacity-75" onclick="hideRecipe()"></div>
            </div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div class="inline-block align-bottom bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full border border-gray-700">
                <div class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg leading-6 font-medium text-white" id="recipe-title"></h3>
                                <button onclick="hideRecipe()" class="text-gray-400 hover:text-white">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="mt-4">
                                <img id="recipe-image" class="w-full h-48 object-cover rounded-lg mb-4" src="" alt="">
                                <div class="flex justify-between items-center mb-4">
                                    <div class="flex items-center">
                                        <i class="fas fa-clock text-gray-400 mr-2"></i>
                                        <span class="text-sm text-gray-300" id="recipe-time"></span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-utensils text-gray-400 mr-2"></i>
                                        <span class="text-sm text-gray-300" id="recipe-servings"></span>
                                    </div>
                                </div>
                                <div class="bg-gray-700 p-4 rounded-lg mb-4">
                                    <h4 class="font-medium text-white mb-2">Ingredients:</h4>
                                    <ul id="recipe-ingredients" class="list-disc list-inside text-gray-300 space-y-1"></ul>
                                </div>
                                <div class="mt-4">
                                    <h4 class="font-medium text-white mb-2">Instructions:</h4>
                                    <ol id="recipe-instructions" class="text-gray-300 space-y-2 list-decimal list-inside"></ol>
                                </div>
                                <div class="mt-6 flex justify-between items-center">
                                    <button onclick="window.location.href='recipe.html?id='+currentRecipeId" class="text-purple-400 border border-purple-400 py-2 px-4 rounded-lg hover:bg-purple-400 hover:text-white transition">
                                        View Full Recipe
                                    </button>
                                    <button onclick="addToCart(currentRecipeId)" class="bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition">
                                        Add to Cart
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-gray-300 body-font bg-gray-800">
        <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
            <a href="index.html" class="flex title-font font-medium items-center md:justify-start justify-center text-white">
                <i class="fas fa-utensils text-purple-500 text-2xl mr-2"></i>
                <span class="ml-3 text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-pink-600">NutriOrder</span>
            </a>
            <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-l-2 sm:border-gray-700 sm:py-2 sm:mt-0 mt-4">© 2023 NutriOrder —
                <a href="#" class="text-gray-300 ml-1" rel="noopener noreferrer" target="_blank">All Rights Reserved</a>
            </p>
            <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
                <a href="#" class="text-gray-400 hover:text-purple-400">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="#" class="ml-3 text-gray-400 hover:text-purple-400">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="#" class="ml-3 text-gray-400 hover:text-purple-400">
                    <i class="fab fa-instagram"></i>
                </a>
            </span>
        </div>
    </footer>

    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;

        // Check for saved user preference or use system preference
        if (localStorage.getItem('theme') === 'dark' || (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            html.classList.add('dark');
        } else {
            html.classList.remove('dark');
        }

        // Toggle theme
        themeToggle.addEventListener('click', () => {
            html.classList.toggle('dark');
            localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light');
        });

        // Profile dropdown functionality
        const profileButton = document.getElementById('profile-button');
        const profileDropdown = document.getElementById('profile-dropdown');

        if (profileButton) {
            profileButton.addEventListener('click', (e) => {
                e.stopPropagation();
                profileDropdown.classList.toggle('hidden');
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function() {
                profileDropdown.classList.add('hidden');
            });
        }

        // Shopping cart functionality
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let currentRecipeId = null;
        
        // Toggle cart visibility
        function toggleCart() {
            const cartSidebar = document.getElementById('cart-sidebar');
            const cartOverlay = document.getElementById('cart-overlay');
            
            cartSidebar.classList.toggle('translate-x-full');
            cartOverlay.classList.toggle('hidden');
        }
        
        // Save cart to localStorage
        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCart();
        }
        
        // Update cart UI
        function updateCart() {
            const cartItemsContainer = document.getElementById('cart-items');
            const cartCount = document.getElementById('cart-count');
            const cartSubtotal = document.getElementById('cart-subtotal');
            const cartTotal = document.getElementById('cart-total');
            
            // Update cart count
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            // Update cart items
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="text-gray-400 text-center py-8">Your cart is empty</p>';
            } else {
                cartItemsContainer.innerHTML = '';
                cart.forEach(item => {
                    const cartItem = document.createElement('div');
                    cartItem.className = 'flex justify-between items-center mb-4 pb-4 border-b border-gray-700';
                    cartItem.innerHTML = `
                        <div class="flex items-center">
                            <img src="${item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded">
                            <div class="ml-3">
                                <h3 class="text-sm font-medium text-white">${item.name}</h3>
                                <p class="text-xs text-gray-400">₹${item.price.toFixed(2)} x ${item.quantity}</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <span class="text-sm font-medium text-white">₹${(item.price * item.quantity).toFixed(2)}</span>
                            <button onclick="removeFromCart(${item.id})" class="ml-2 text-red-400 hover:text-red-300">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
                    cartItemsContainer.appendChild(cartItem);
                });
            }
            
            // Update totals
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const deliveryFee = 30; // 30 INR delivery fee
            const total = subtotal + deliveryFee;
            
            cartSubtotal.textContent = `₹${subtotal.toFixed(2)}`;
            cartTotal.textContent = `₹${total.toFixed(2)}`;
        }

        // Add item to cart
        function addToCart(itemId) {
            const item = foodItems.find(i => i.id === itemId);
            const existingItem = cart.find(i => i.id === itemId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({...item, quantity: 1});
            }
            
            saveCart();
            showAddedToCartMessage(item.name);
        }

        // Remove item from cart
        function removeFromCart(itemId) {
            const itemIndex = cart.findIndex(i => i.id === itemId);
            
            if (itemIndex !== -1) {
                if (cart[itemIndex].quantity > 1) {
                    cart[itemIndex].quantity -= 1;
                } else {
                    cart.splice(itemIndex, 1);
                }
                
                saveCart();
            }
        }

        // Show notification when item is added to cart
        function showAddedToCartMessage(itemName) {
            const notification = document.createElement('div');
            notification.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center';
            notification.innerHTML = `
                <i class="fas fa-check-circle mr-2"></i>
                ${itemName} added to cart!
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('opacity-0', 'transition-opacity', 'duration-300');
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        // Healthy food items database
        const foodItems = [
            // Vegetarian Indian dishes
            {
                id: 1,
                name: "Dal Makhani",
                category: "Indian",
                diet: ["vegetarian", "gluten-free", "high-protein"],
                price: 220,
                description: "Creamy black lentils cooked with minimal oil",
                image: "https://images.unsplash.com/photo-1601050690597-df0568f70950?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                healthScore: 9,
                calories: 320,
                protein: 18,
                carbs: 40,
                fat: 10,
                restaurantId: 1,
                prepTime: "10 mins",
                servings: "4 servings"
            },
            {
                id: 2,
                name: "Quinoa Upma",
                category: "Indian",
                diet: ["vegetarian", "vegan", "gluten-free", "high-protein"],
                price: 180,
                description: "Quinoa cooked with Indian spices and vegetables",
                image: "https://images.unsplash.com/photo-1547592180-85f173990554?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                healthScore: 8,
                calories: 280,
                protein: 10,
                carbs: 45,
                fat: 8,
                restaurantId: 1,
                prepTime: "15 mins",
                servings: "2 servings"
            },
            {
                id: 3,
                name: "Oats Poha",
                category: "Indian",
                diet: ["vegetarian", "gluten-free"],
                price: 150,
                description: "Steel-cut oats prepared like traditional poha",
                image: "https://images.unsplash.com/photo-1608500218954-bafec1ae555c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                healthScore: 8,
                calories: 250,
                protein: 8,
                carbs: 40,
                fat: 6,
                restaurantId: 1,
                prepTime: "10 mins",
                servings: "2 servings"
            },
            // Vegan Indian dishes
            {
                id: 4,
                name: "Vegan Buddha Bowl",
                category: "Indian",
                diet: ["vegetarian", "vegan", "gluten-free"],
                price: 200,
                description: "Nutritious bowl with quinoa, roasted vegetables, and tahini dressing",
                image: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=880&q=80",
                healthScore: 9,
                calories: 300,
                protein: 10,
                carbs: 45,
                fat: 10,
                restaurantId: 1,
                prepTime: "25 mins",
                servings: "1 serving"
            },
            // Gluten-free Indian dishes
            {
                id: 5,
                name: "Grilled Salmon with Steamed Vegetables",
                category: "Indian",
                diet: ["gluten-free", "high-protein", "low-carb"],
                price: 320,
                description: "Fresh salmon with seasonal steamed vegetables",
                image: "https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                healthScore: 10,
                calories: 350,
                protein: 35,
                carbs: 10,
                fat: 20,
                restaurantId: 2,
                prepTime: "30 mins",
                servings: "1 serving"
            },
            // Keto Indian dishes
            {
                id: 6,
                name: "Keto Butter Chicken",
                category: "Indian",
                diet: ["keto", "low-carb"],
                price: 280,
                description: "Tender chicken in rich tomato and butter gravy",
                image: "https://images.unsplash.com/photo-1603360946369-dc9bb6258143?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                healthScore: 8,
                calories: 380,
                protein: 28,
                carbs: 6,
                fat: 28,
                restaurantId: 2,
                prepTime: "35 mins",
                servings: "2 servings"
            },
            // Low-carb Indian dishes
            {
                id: 7,
                name: "Tandoori Chicken with Salad",
                category: "Indian",
                diet: ["low-carb", "high-protein", "gluten-free"],
                price: 260,
                description: "Grilled chicken with fresh garden salad",
                image: "https://images.unsplash.com/photo-1601050690597-df0568f70950?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                healthScore: 9,
                calories: 300,
                protein: 40,
                carbs: 8,
                fat: 12,
                restaurantId: 2,
                prepTime: "30 mins",
                servings: "1 serving"
            },
            // High-protein Indian dishes
            {
                id: 8,
                name: "Paneer Protein Shake",
                category: "Indian",
                diet: ["high-protein", "vegetarian"],
                price: 180,
                description: "Blend of paneer, banana, almond butter and milk",
                image: "https://images.unsplash.com/photo-1519996521439-0408c916b631?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                healthScore: 9,
                calories: 350,
                protein: 25,
                carbs: 30,
                fat: 15,
                restaurantId: 3,
                prepTime: "5 mins",
                servings: "1 serving"
            },
            // Italian dishes
            {
                id: 9,
                name: "Whole Wheat Pasta Primavera",
                category: "Italian",
                diet: ["vegetarian"],
                price: 250,
                description: "Whole wheat pasta with fresh seasonal vegetables",
                image: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                healthScore: 7,
                calories: 350,
                protein: 15,
                carbs: 55,
                fat: 8,
                restaurantId: 3,
                prepTime: "25 mins",
                servings: "2 servings"
            },
            // Chinese dishes
            {
                id: 10,
                name: "Steamed Fish with Ginger and Spring Onions",
                category: "Chinese",
                diet: ["gluten-free", "low-carb", "high-protein"],
                price: 280,
                description: "Fresh fish steamed with ginger and spring onions",
                image: "https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                healthScore: 9,
                calories: 250,
                protein: 30,
                carbs: 5,
                fat: 12,
                restaurantId: 3,
                prepTime: "20 mins",
                servings: "1 serving"
            }
        ];

        // Recipe data for all foods
        const recipes = {
            1: {
                title: "Dal Makhani Recipe",
                ingredients: [
                    "1 cup whole black lentils (urad dal)",
                    "1/4 cup kidney beans (rajma)",
                    "1 onion, finely chopped",
                    "2 tomatoes, pureed",
                    "1 tbsp ginger-garlic paste",
                    "1 tsp cumin seeds",
                    "1 tsp coriander powder",
                    "1/2 tsp garam masala",
                    "1/2 tsp turmeric powder",
                    "1 tsp red chili powder",
                    "1 tbsp oil",
                    "1 tbsp butter",
                    "1/2 cup cream",
                    "Salt to taste",
                    "Fresh coriander for garnish"
                ],
                instructions: [
                    "Soak lentils and kidney beans overnight. Pressure cook until soft.",
                    "Heat oil and butter in a pan, add cumin seeds and let them splutter.",
                    "Add onions and sauté until golden. Add ginger-garlic paste and sauté for a minute.",
                    "Add tomato puree and cook until oil separates. Add all dry spices and salt.",
                    "Add cooked lentils and beans along with some water. Simmer for 30 minutes, stirring occasionally.",
                    "Add cream and simmer for another 10 minutes. Garnish with fresh coriander.",
                    "Serve hot with roti or rice."
                ]
            },
            2: {
                title: "Quinoa Upma Recipe",
                ingredients: [
                    "1 cup quinoa, rinsed",
                    "2 cups water",
                    "1 onion, finely chopped",
                    "1 carrot, diced",
                    "1/2 cup green peas",
                    "1 green chili, chopped",
                    "1 tsp mustard seeds",
                    "1 tsp cumin seeds",
                    "1/2 tsp turmeric powder",
                    "1 tbsp oil",
                    "Salt to taste",
                    "Fresh coriander for garnish",
                    "Lemon wedges for serving"
                ],
                instructions: [
                    "Dry roast quinoa in a pan for 2-3 minutes until fragrant. Set aside.",
                    "Heat oil in a pan, add mustard and cumin seeds. Let them splutter.",
                    "Add onions and green chili, sauté until onions are translucent.",
                    "Add carrots and peas, sauté for 2 minutes. Add turmeric and salt.",
                    "Add quinoa and water, bring to a boil. Reduce heat, cover and simmer for 15 minutes.",
                    "Fluff with fork, garnish with coriander. Serve hot with lemon wedges."
                ]
            },
            3: {
                title: "Oats Poha Recipe",
                ingredients: [
                    "2 cups steel-cut oats",
                    "1 onion, finely chopped",
                    "1 green chili, chopped",
                    "1/2 tsp mustard seeds",
                    "1/2 tsp cumin seeds",
                    "10-12 curry leaves",
                    "2 tbsp peanuts",
                    "1/2 tsp turmeric powder",
                    "1 tbsp lemon juice",
                    "1 tbsp oil",
                    "Salt to taste",
                    "Fresh coriander for garnish"
                ],
                instructions: [
                    "Rinse oats and soak in water for 5 minutes. Drain and set aside.",
                    "Heat oil in a pan, add mustard and cumin seeds. Let them splutter.",
                    "Add peanuts and roast until golden. Add curry leaves, green chili and onions. Sauté until onions are soft.",
                    "Add turmeric powder and salt. Mix well.",
                    "Add soaked oats and stir gently to combine all ingredients.",
                    "Cover and cook on low heat for 3-4 minutes. Sprinkle lemon juice and garnish with coriander.",
                    "Serve hot with yogurt or chutney."
                ]
            },
            4: {
                title: "Vegan Buddha Bowl Recipe",
                ingredients: [
                    "1/2 cup cooked quinoa",
                    "1/2 cup roasted sweet potatoes",
                    "1/2 cup steamed broccoli",
                    "1/4 avocado, sliced",
                    "1/4 cup shredded purple cabbage",
                    "2 tbsp hummus",
                    "1 tbsp tahini",
                    "1 tsp lemon juice",
                    "1 tsp maple syrup",
                    "Salt and pepper to taste",
                    "Pumpkin seeds for garnish"
                ],
                instructions: [
                    "Arrange all vegetables and quinoa in a bowl.",
                    "In a small bowl, mix tahini, lemon juice, maple syrup, salt and pepper to make dressing.",
                    "Drizzle dressing over the bowl. Add hummus on the side.",
                    "Garnish with pumpkin seeds and serve."
                ]
            },
            5: {
                title: "Grilled Salmon with Steamed Vegetables Recipe",
                ingredients: [
                    "1 salmon fillet (about 150g)",
                    "1 tsp olive oil",
                    "1/2 tsp lemon zest",
                    "1/2 tsp dried dill",
                    "Salt and pepper to taste",
                    "1 cup mixed vegetables (broccoli, carrots, zucchini)",
                    "Lemon wedges for serving"
                ],
                instructions: [
                    "Preheat grill to medium-high heat.",
                    "Rub salmon with olive oil, lemon zest, dill, salt and pepper.",
                    "Grill salmon for 4-5 minutes per side until cooked through.",
                    "Meanwhile, steam vegetables until tender-crisp (about 5 minutes).",
                    "Serve salmon with steamed vegetables and lemon wedges."
                ]
            },
            6: {
                title: "Keto Butter Chicken Recipe",
                ingredients: [
                    "500g chicken thighs, boneless",
                    "1/2 cup plain yogurt",
                    "2 tbsp lemon juice",
                    "1 tbsp ginger-garlic paste",
                    "1 tsp garam masala",
                    "1 tsp turmeric powder",
                    "1 tsp chili powder",
                    "2 tbsp butter",
                    "1 onion, finely chopped",
                    "1 cup tomato puree",
                    "1/2 cup heavy cream",
                    "1 tsp fenugreek leaves",
                    "Salt to taste"
                ],
                instructions: [
                    "Marinate chicken with yogurt, lemon juice, ginger-garlic paste and spices for at least 1 hour.",
                    "Grill or bake the chicken until cooked through. Set aside.",
                    "In a pan, melt butter and sauté onions until golden. Add tomato puree and cook for 5 minutes.",
                    "Add cream and simmer for 5 minutes. Add fenugreek leaves and salt.",
                    "Add grilled chicken pieces and simmer for 5-10 minutes.",
                    "Serve hot with cauliflower rice or low-carb naan."
                ]
            },
            7: {
                title: "Tandoori Chicken Recipe",
                ingredients: [
                    "1 kg chicken (legs or breast)",
                    "1 cup yogurt",
                    "2 tbsp lemon juice",
                    "2 tbsp ginger-garlic paste",
                    "1 tsp turmeric powder",
                    "1 tbsp red chili powder",
                    "1 tbsp garam masala",
                    "1 tsp cumin powder",
                    "1 tsp coriander powder",
                    "1 tbsp kasuri methi (dried fenugreek leaves)",
                    "Salt to taste",
                    "2 tbsp oil",
                    "Lemon wedges and onion rings for serving"
                ],
                instructions: [
                    "Make deep cuts in the chicken pieces for marinade to penetrate.",
                    "Mix all marinade ingredients (yogurt, spices, lemon juice) in a bowl.",
                    "Coat chicken pieces thoroughly with marinade. Refrigerate for at least 4 hours, preferably overnight.",
                    "Preheat oven to 200°C (400°F). Place chicken on a wire rack over baking tray.",
                    "Bake for 25-30 minutes, turning once halfway through. Brush with oil during last 5 minutes.",
                    "Broil for 2-3 minutes for charred effect.",
                    "Serve hot with lemon wedges and onion rings."
                ]
            },
            8: {
                title: "Paneer Protein Shake Recipe",
                ingredients: [
                    "100g paneer (cottage cheese)",
                    "1 banana",
                    "1 tbsp almond butter",
                    "1 cup milk (or almond milk)",
                    "1 tsp honey (optional)",
                    "1/2 tsp cinnamon powder",
                    "Ice cubes (optional)"
                ],
                instructions: [
                    "Cut paneer into small cubes for easier blending.",
                    "Add all ingredients to a blender.",
                    "Blend until smooth and creamy. Add more milk if needed for desired consistency.",
                    "Pour into glass and serve immediately.",
                    "For chilled version, add ice cubes before blending."
                ]
            },
            9: {
                title: "Whole Wheat Pasta Primavera Recipe",
                ingredients: [
                    "2 cups whole wheat pasta",
                    "2 cups mixed vegetables (zucchini, bell peppers, cherry tomatoes, broccoli)",
                    "2 cloves garlic, minced",
                    "2 tbsp olive oil",
                    "1/4 cup grated parmesan cheese",
                    "Salt and pepper to taste",
                    "Fresh basil leaves for garnish"
                ],
                instructions: [
                    "Cook pasta according to package instructions. Reserve 1/2 cup pasta water.",
                    "Heat olive oil in a pan, add garlic and sauté for 30 seconds.",
                    "Add vegetables and sauté for 5-7 minutes until tender-crisp.",
                    "Add cooked pasta, reserved pasta water, salt and pepper. Toss to combine.",
                    "Sprinkle with parmesan cheese and garnish with fresh basil.",
                    "Serve immediately."
                ]
            },
            10: {
                title: "Steamed Fish with Ginger and Spring Onions Recipe",
                ingredients: [
                    "1 white fish fillet (like basa or cod)",
                    "1 inch ginger, julienned",
                    "2 spring onions, sliced",
                    "1 tbsp light soy sauce",
                    "1 tsp sesame oil",
                    "1/2 tsp sugar",
                    "1/4 cup water",
                    "Fresh coriander for garnish"
                ],
                instructions: [
                    "Place fish on a heatproof plate that fits in your steamer.",
                    "Top fish with ginger and half the spring onions.",
                    "Mix soy sauce, sesame oil, sugar and water. Pour over fish.",
                    "Steam for 8-10 minutes until fish flakes easily with a fork.",
                    "Garnish with remaining spring onions and fresh coriander.",
                    "Serve hot with steamed rice or vegetables."
                ]
            }
        };

        // Restaurants data
        const restaurants = [
            {
                id: 1,
                name: "Healthy Bites",
                cuisine: "Indian",
                specialties: ["Vegetarian", "Vegan", "Gluten-Free"],
                rating: 4.5,
                reviews: 120,
                image: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                description: "Healthy Indian vegetarian cuisine with organic ingredients. Specializing in nutritious meals made with superfoods."
            },
            {
                id: 2,
                name: "Lean & Green",
                cuisine: "International",
                specialties: ["Keto", "Low-Carb", "High-Protein"],
                rating: 4.7,
                reviews: 85,
                image: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1074&q=80",
                description: "Healthy international cuisine tailored for fitness enthusiasts. All dishes are balanced for optimal nutrition."
            },
            {
                id: 3,
                name: "Organic Delight",
                cuisine: "International",
                specialties: ["Organic", "Healthy", "Vegetarian"],
                rating: 4.3,
                reviews: 95,
                image: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                description: "International cuisine with a focus on organic and healthy ingredients. Our menu features dishes from around the world with Indian influences."
            }
        ];

        // Health tips based on preferences
        const healthTips = [
            {
                title: "Balanced Nutrition",
                content: "Since you indicated you're health conscious, try to include a variety of colorful vegetables in each meal for maximum nutrient diversity."
            },
            {
                title: "Portion Control",
                content: "Even with healthy foods, portion size matters. Our recommendations are already portion-controlled for optimal health benefits."
            },
            {
                title: "Protein Intake",
                content: "Based on your fitness goals, we recommend consuming adequate protein to support muscle growth and recovery."
            },
            {
                title: "Hydration",
                content: "Remember to drink plenty of water throughout the day, especially if you're following a high-protein diet."
            }
        ];

        // Sample user preferences (would normally come from your backend)
        const userPreferences = {
            diet: ["vegetarian", "gluten-free"], // User's dietary preferences
            health_condition: [], // Any health conditions
            fitness_goal: "weight-loss", // User's fitness goal
            current_weight: 75, // in kg
            target_weight: 70, // in kg
            activity_level: "moderate", // Activity level
            allergy: [], // Food allergies
            meal_pref: ["high-protein", "low-carb"] // Meal preferences
        };

        // Function to recommend foods based on user preferences
        function recommendFoods() {
            // Filter foods based on user's dietary preferences
            let recommended = foodItems.filter(item => {
                // Check if food matches any of the user's dietary preferences
                const matchesDiet = userPreferences.diet.length === 0 || 
                    userPreferences.diet.some(pref => item.diet.includes(pref));
                
                // Check if food matches any of the user's meal preferences
                const matchesMealPref = userPreferences.meal_pref.length === 0 || 
                    userPreferences.meal_pref.some(pref => item.diet.includes(pref));
                
                // For users with weight loss goal, prioritize lower calorie options
                const matchesFitnessGoal = userPreferences.fitness_goal !== "weight-loss" || 
                    item.calories < 400;
                
                return matchesDiet && matchesMealPref && matchesFitnessGoal;
            });

            // Sort by health score (higher is better)
            recommended.sort((a, b) => b.healthScore - a.healthScore);

            return recommended;
        }

        // Function to recommend restaurants based on user preferences
        function recommendRestaurants() {
            // In a real app, this would be more sophisticated
            // For now, we'll just filter by cuisine if specified
            return restaurants.filter(restaurant => {
                // If user has Indian dietary preferences, show Indian restaurants
                if (userPreferences.diet.includes("vegetarian") || 
                    userPreferences.diet.includes("vegan")) {
                    return restaurant.cuisine === "Indian";
                }
                return true;
            });
        }

        // Function to get menu items for a specific restaurant
        function getRestaurantMenu(restaurantId) {
            return foodItems.filter(item => item.restaurantId === restaurantId);
        }

        // Function to show restaurant menu
        function showRestaurantMenu(restaurantId) {
            const restaurant = restaurants.find(r => r.id === restaurantId);
            if (!restaurant) return;
            
            const menuItems = getRestaurantMenu(restaurantId);
            
            document.getElementById('restaurant-menu-title').textContent = `${restaurant.name} Menu`;
            document.getElementById('restaurant-menu-description').textContent = restaurant.description;
            
            const menuContainer = document.getElementById('restaurant-menu-items');
            menuContainer.innerHTML = '';
            
            if (menuItems.length === 0) {
                menuContainer.innerHTML = '<p class="text-gray-400 col-span-full text-center py-8">No menu items available for this restaurant.</p>';
            } else {
                menuItems.forEach(item => {
                    const menuItem = document.createElement('div');
                    menuItem.className = 'bg-gray-700 p-4 rounded-lg shadow';
                    menuItem.innerHTML = `
                        <div class="flex items-start">
                            <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded">
                            <div class="ml-3 flex-1">
                                <h4 class="font-medium text-white">${item.name}</h4>
                                <p class="text-sm text-gray-300">${item.description}</p>
                                <div class="mt-2 flex justify-between items-center">
                                    <span class="text-purple-400 font-medium">₹${item.price.toFixed(2)}</span>
                                    <div class="flex space-x-2">
                                        <button onclick="showRecipe(${item.id})" class="text-purple-400 text-sm hover:underline">
                                            View Recipe
                                        </button>
                                        <button onclick="addToCart(${item.id})" class="text-white bg-purple-600 text-sm py-1 px-3 rounded hover:bg-purple-700 transition">
                                            Add to Cart
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    menuContainer.appendChild(menuItem);
                });
            }
            
            document.getElementById('restaurant-menu-modal').classList.remove('hidden');
        }

        // Function to hide restaurant menu
        function hideRestaurantMenu() {
            document.getElementById('restaurant-menu-modal').classList.add('hidden');
        }

        // Show recipe modal
        function showRecipe(itemId) {
            const foodItem = foodItems.find(item => item.id === itemId);
            const recipe = recipes[itemId];
            
            if (!foodItem || !recipe) {
                // If recipe not found in modal data, redirect to full recipe page
                window.location.href = 'recipe.html?id=' + itemId;
                return;
            }
            
            currentRecipeId = itemId;
            
            document.getElementById('recipe-title').textContent = recipe.title;
            document.getElementById('recipe-image').src = foodItem.image;
            document.getElementById('recipe-time').textContent = foodItem.prepTime;
            document.getElementById('recipe-servings').textContent = foodItem.servings;
            
            const ingredientsList = document.getElementById('recipe-ingredients');
            ingredientsList.innerHTML = '';
            recipe.ingredients.forEach(ingredient => {
                const li = document.createElement('li');
                li.textContent = ingredient;
                ingredientsList.appendChild(li);
            });
            
            const instructionsList = document.getElementById('recipe-instructions');
            instructionsList.innerHTML = '';
            recipe.instructions.forEach(instruction => {
                const li = document.createElement('li');
                li.textContent = instruction;
                instructionsList.appendChild(li);
            });
            
            document.getElementById('recipe-modal').classList.remove('hidden');
        }

        // Hide recipe modal
        function hideRecipe() {
            document.getElementById('recipe-modal').classList.add('hidden');
            currentRecipeId = null;
        }

        // Function to display recommended foods
        function displayRecommendedFoods(foods) {
            const container = document.getElementById('recommended-foods');
            container.innerHTML = '';

            if (foods.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <p class="text-gray-400">No recommended foods found based on your preferences.</p>
                        <a href="preferences.html" class="mt-4 inline-block text-purple-400 hover:underline">
                            Update your preferences
                        </a>
                    </div>
                `;
                return;
            }

            foods.forEach(food => {
                const foodCard = document.createElement('div');
                foodCard.className = 'bg-gray-800 rounded-lg shadow overflow-hidden hover:shadow-lg transition transform hover:-translate-y-1';
                foodCard.innerHTML = `
                    <div class="relative">
                        <img class="w-full h-48 object-cover" src="${food.image}" alt="${food.name}">
                        ${userPreferences.diet.some(d => food.diet.includes(d)) ? 
                            `<div class="absolute top-2 left-2 bg-green-900 text-green-200 text-xs font-semibold px-2.5 py-0.5 rounded">
                                ${userPreferences.diet.find(d => food.diet.includes(d)).toUpperCase()}
                            </div>` : ''}
                        <div class="absolute top-2 right-2 bg-purple-600 text-white text-xs font-semibold px-2.5 py-0.5 rounded">RECOMMENDED</div>
                    </div>
                    <div class="p-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="text-lg font-semibold text-white">${food.name}</h3>
                                <p class="text-sm text-gray-400">${food.category} • ${food.diet.join(', ')}</p>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-star text-yellow-400 mr-1"></i>
                                <span class="text-white">${(food.healthScore / 2).toFixed(1)}</span>
                            </div>
                        </div>
                        <p class="mt-2 text-sm text-gray-300">${food.description}</p>
                        <div class="mt-3 grid grid-cols-3 gap-2 text-xs text-center">
                            <div class="bg-gray-700 p-1 rounded">
                                <div class="font-medium">${food.calories}</div>
                                <div class="text-gray-400">CAL</div>
                            </div>
                            <div class="bg-gray-700 p-1 rounded">
                                <div class="font-medium">${food.protein}g</div>
                                <div class="text-gray-400">PRO</div>
                            </div>
                            <div class="bg-gray-700 p-1 rounded">
                                <div class="font-medium">${food.carbs}g</div>
                                <div class="text-gray-400">CARB</div>
                            </div>
                        </div>
                        <div class="mt-4 flex justify-between items-center">
                            <span class="text-lg font-bold text-white">₹${food.price.toFixed(2)}</span>
                            <div class="flex space-x-2">
                                <button onclick="showRecipe(${food.id})" class="text-purple-400 border border-purple-400 py-1 px-3 focus:outline-none hover:bg-purple-400 hover:text-white rounded text-sm transition">
                                    View Recipe
                                </button>
                                <button onclick="addToCart(${food.id})" class="text-white bg-purple-600 border-0 py-1 px-3 focus:outline-none hover:bg-purple-700 rounded text-sm transition">
                                    Add to Cart
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(foodCard);
            });
        }

        // Function to display recommended restaurants
        function displayRecommendedRestaurants(restaurants) {
            const container = document.getElementById('recommended-restaurants');
            container.innerHTML = '';

            restaurants.forEach(restaurant => {
                const restaurantCard = document.createElement('div');
                restaurantCard.className = 'bg-gray-800 rounded-lg shadow overflow-hidden hover:shadow-lg transition transform hover:-translate-y-1';
                restaurantCard.innerHTML = `
                    <img class="w-full h-48 object-cover" src="${restaurant.image}" alt="${restaurant.name}">
                    <div class="p-4">
                        <h3 class="text-lg font-semibold text-white">${restaurant.name}</h3>
                        <div class="flex items-center mt-2">
                            <div class="flex text-yellow-400">
                                ${Array(Math.floor(restaurant.rating)).fill().map(() => '<i class="fas fa-star"></i>').join('')}
                                ${restaurant.rating % 1 >= 0.5 ? '<i class="fas fa-star-half-alt"></i>' : ''}
                                ${Array(5 - Math.ceil(restaurant.rating)).fill().map(() => '<i class="far fa-star"></i>').join('')}
                            </div>
                            <span class="ml-2 text-sm text-gray-400">${restaurant.rating} (${restaurant.reviews} reviews)</span>
                        </div>
                        <div class="mt-2 flex flex-wrap gap-2">
                            ${restaurant.specialties.map(spec => 
                                `<span class="text-xs bg-purple-900 text-purple-300 px-2 py-1 rounded">${spec}</span>`
                            ).join('')}
                        </div>
                        <p class="mt-2 text-sm text-gray-300">Specializing in ${restaurant.specialties.join(', ').toLowerCase()} cuisine.</p>
                        <button onclick="showRestaurantMenu(${restaurant.id})" class="mt-4 w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition">
                            View Menu
                        </button>
                    </div>
                `;
                container.appendChild(restaurantCard);
            });
        }

        // Function to display health tips
        function displayHealthTips() {
            const container = document.getElementById('health-tips');
            container.innerHTML = '';

            // Select 2 random health tips (or all if less than 2)
            const tipsToShow = healthTips.sort(() => 0.5 - Math.random()).slice(0, 2);
            
            tipsToShow.forEach(tip => {
                const tipCard = document.createElement('div');
                tipCard.className = 'bg-gray-800 p-4 rounded-lg shadow';
                tipCard.innerHTML = `
                    <h3 class="font-semibold text-lg text-white mb-2">${tip.title}</h3>
                    <p class="text-gray-300">${tip.content}</p>
                `;
                container.appendChild(tipCard);
            });
        }

        // Filter foods based on search and filters
        function filterFoods() {
            const searchTerm = document.getElementById('food-search').value.toLowerCase();
            const cuisineFilter = document.getElementById('cuisine-filter').value.toLowerCase();
            const dietFilter = document.getElementById('diet-filter').value.toLowerCase();
            
            let filtered = recommendFoods();
            
            if (searchTerm) {
                filtered = filtered.filter(item => 
                    item.name.toLowerCase().includes(searchTerm) || 
                    item.description.toLowerCase().includes(searchTerm) ||
                    item.category.toLowerCase().includes(searchTerm)
                );
            }
            
            if (cuisineFilter) {
                filtered = filtered.filter(item => 
                    item.category.toLowerCase().includes(cuisineFilter)
                );
            }
            
            if (dietFilter) {
                filtered = filtered.filter(item => 
                    item.diet.some(d => d.toLowerCase().includes(dietFilter))
                );
            }
            
            displayRecommendedFoods(filtered);
        }

        // Reset filters
        function resetFilters() {
            document.getElementById('food-search').value = '';
            document.getElementById('cuisine-filter').value = '';
            document.getElementById('diet-filter').value = '';
            displayRecommendedFoods(recommendFoods());
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize cart from localStorage
            updateCart();
            
            // Display recommendations based on user preferences
            displayRecommendedFoods(recommendFoods());
            displayRecommendedRestaurants(recommendRestaurants());
            displayHealthTips();
            
            // Set up event listeners for search and filters
            document.getElementById('food-search').addEventListener('input', filterFoods);
            document.getElementById('cuisine-filter').addEventListener('change', filterFoods);
            document.getElementById('diet-filter').addEventListener('change', filterFoods);
            document.getElementById('reset-filters').addEventListener('click', resetFilters);
            
            // Check if user is logged in
            const userData = JSON.parse(localStorage.getItem('userData'));
            
            if (userData) {
                // Show profile section and update with user data
                const profileSection = document.getElementById('profile-section');
                const profileName = document.getElementById('profile-name');
                const profileButton = document.getElementById('profile-button');
                
                // Show the profile section that was hidden by default
                profileSection.classList.remove('hidden');
                
                // Set the profile name
                profileName.textContent = userData.displayName || userData.email || 'User';
                
                // Replace font awesome icon with profile picture if available
                if (userData.photoURL) {
                    // Remove the existing font awesome icon
                    const iconElement = profileButton.querySelector('.fas.fa-user-circle');
                    if (iconElement) {
                        iconElement.remove();
                    }
                    
                    // Create profile picture element
                    const profilePic = document.createElement('img');
                    profilePic.src = userData.photoURL;
                    profilePic.alt = 'Profile';
                    profilePic.className = 'h-8 w-8 rounded-full object-cover mr-2';
                    
                    // Add it to the beginning of the profile button
                    profileButton.prepend(profilePic);
                }
                
                // Set up dropdown toggle
                profileButton.addEventListener('click', function() {
                    const dropdown = document.getElementById('profile-dropdown');
                    dropdown.classList.toggle('hidden');
                });
                
                // Close dropdown when clicking outside
                document.addEventListener('click', function(event) {
                    const dropdown = document.getElementById('profile-dropdown');
                    const profileButton = document.getElementById('profile-button');
                    
                    if (!profileButton.contains(event.target) && !dropdown.contains(event.target)) {
                        dropdown.classList.add('hidden');
                    }
                });
            }
        });

        // Add this script to your pages where the profile section exists
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in with data in localStorage
            const userData = JSON.parse(localStorage.getItem('userData') || '{}');
            
            // Get the profile section elements
            const profileSection = document.getElementById('profile-section');
            const profileName = document.getElementById('profile-name');
            const profileButton = document.getElementById('profile-button');
            
            if (userData && userData.photoURL && profileButton) {
                // Show the profile section if it was hidden
                if (profileSection) {
                    profileSection.classList.remove('hidden');
                }
                
                // Update the profile name if it exists
                if (profileName) {
                    profileName.textContent = userData.displayName || userData.email || 'User';
                }
                
                // Find the existing icon to replace
                const existingIcon = profileButton.querySelector('.fas.fa-user-circle');
                
                // If we found the icon, replace it with the profile picture
                if (existingIcon) {
                    // Create profile picture element
                    const profilePic = document.createElement('img');
                    profilePic.src = userData.photoURL;
                    profilePic.alt = 'Profile';
                    profilePic.className = 'h-8 w-8 rounded-full object-cover mr-2';
                    
                    // Replace the icon with the profile picture
                    existingIcon.parentNode.replaceChild(profilePic, existingIcon);
                }
            } else if (userData && userData.displayName && profileName) {
                // If there's no photo but there is a name, at least show the name
                profileSection.classList.remove('hidden');
                profileName.textContent = userData.displayName || userData.email || 'User';
            }
        });
        
        // Add smooth transition to all links
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', function(e) {
                    // Don't apply to:
                    // 1. External links
                    // 2. Anchor links (#)
                    // 3. Links to the current page
                    if (!this.href || 
                        this.href.startsWith('http') || 
                        this.href.includes('#') || 
                        this.href === window.location.href) {
                        return;
                    }
                    
                    e.preventDefault();
                    document.body.style.opacity = '0';
                    document.body.style.transition = 'opacity 0.3s ease';
                    
                    setTimeout(() => {
                        window.location.href = this.href;
                    }, 300);
                });
            });
        });
    </script>
</body>
</html>